{"version":3,"file":"src_app_features_account_pages_admin_admin_module_ts.9ef4d5a7baace6bc.js","mappings":"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","names":["i0","AdminComponent","constructor","productsService","authService","dialog","cdr","spinner","alert","this","ngOnInit","getProducts","then","products","productsDataSource","MatTableDataSource","filterPredicate","productFilterPredicate","paginator","productsPaginator","sort","productsSort","ngAfterViewInit","nonAdminUsers","getPlatformUsers","filter","user","role","usersDataSource","detectChanges","userFilterPredicate","usersPaginator","usersSort","data","lowerCaseFilter","toLowerCase","title","includes","category","firstName","email","username","openProductDialog","id","open","ProductDialogComponent","width","afterClosed","subscribe","result","_this","show","updateProduct","error","console","log","createErrorDialog","hide","addNewProduct","markUserAsAdmin","ev","checked","createConfirmDenyDialog","_this2","changeUserToAdmin","source","applyProductsFilter","event","target","value","trim","firstPage","applyUserFilter","core","selectors","MatPaginator","MatSort","ctx","routes","path","component","AdminRoutingModule","RouterModule","AdminModule","SharedModule","AccountModule"],"sourceRoot":"webpack:///","sources":["./src/app/features/account/pages/admin/admin.component.html","./src/app/features/account/pages/admin/admin.component.ts","./src/app/features/account/pages/admin/admin-routing.module.ts","./src/app/features/account/pages/admin/admin.module.ts"],"sourcesContent":["<div class=\"admin-container\">\n  <mat-tab-group mat-stretch-tabs=\"true\" mat-align-tabs=\"center\">\n    <mat-tab label=\"Products\">\n      <div class=\"admin-products-container\">\n        <button mat-raised-button color=\"accent\" (click)=\"openProductDialog()\">\n          Add new Product\n        </button>\n\n        <mat-form-field>\n          <mat-label>Search Product</mat-label>\n          <input\n            matInput\n            (keyup)=\"applyProductsFilter($event)\"\n            placeholder=\"Enter the product name or category\"\n            #input\n          />\n        </mat-form-field>\n\n        <div class=\"table-container mat-elevation-z8\">\n          <table\n            mat-table\n            [dataSource]=\"productsDataSource\"\n            matSort\n            #productsSort\n          >\n            <ng-container matColumnDef=\"id\">\n              <th mat-header-cell *matHeaderCellDef mat-sort-header>ID</th>\n              <td mat-cell *matCellDef=\"let product\">{{ product.id }}</td>\n            </ng-container>\n\n            <ng-container matColumnDef=\"title\">\n              <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>\n              <td mat-cell *matCellDef=\"let product\">{{ product.title }}</td>\n            </ng-container>\n\n            <ng-container matColumnDef=\"category\">\n              <th mat-header-cell *matHeaderCellDef>Category</th>\n              <td mat-cell *matCellDef=\"let product\">{{ product.category }}</td>\n            </ng-container>\n\n            <ng-container matColumnDef=\"stock\">\n              <th mat-header-cell *matHeaderCellDef mat-sort-header>Stock</th>\n              <td mat-cell *matCellDef=\"let product\">{{ product.stock }}</td>\n            </ng-container>\n\n            <ng-container matColumnDef=\"price\">\n              <th mat-header-cell *matHeaderCellDef>Price</th>\n              <td mat-cell *matCellDef=\"let product\">\n                {{ product.price | currency : \"USD\" : \"symbol\" }}\n              </td>\n            </ng-container>\n\n            <ng-container matColumnDef=\"actions\">\n              <th mat-header-cell *matHeaderCellDef>Actions</th>\n              <td mat-cell *matCellDef=\"let product\">\n                <button\n                  mat-icon-button\n                  color=\"primary\"\n                  (click)=\"openProductDialog(product.id)\"\n                >\n                  <mat-icon>edit</mat-icon>\n                </button>\n                <button mat-icon-button color=\"warn\">\n                  <mat-icon>delete</mat-icon>\n                </button>\n              </td>\n            </ng-container>\n\n            <tr\n              mat-header-row\n              *matHeaderRowDef=\"productsDisplayedColumns; sticky: true\"\n            ></tr>\n            <tr\n              mat-row\n              *matRowDef=\"let row; columns: productsDisplayedColumns\"\n            ></tr>\n\n            <tr class=\"mat-row\" *matNoDataRow>\n              <td\n                class=\"mat-cell\"\n                [colSpan]=\"productsDisplayedColumns.length\"\n                align=\"center\"\n              >\n                No product found\n              </td>\n            </tr>\n          </table>\n\n          <mat-paginator\n            #productsPaginator\n            class=\"mat-paginator-sticky\"\n            [pageSizeOptions]=\"[5, 10, 25, 100]\"\n          ></mat-paginator>\n        </div>\n      </div>\n    </mat-tab>\n\n    <mat-tab label=\"Users\">\n      <div class=\"admin-users-container\">\n        <mat-form-field>\n          <mat-label>Search User</mat-label>\n          <input\n            matInput\n            (keyup)=\"applyUserFilter($event)\"\n            placeholder=\"Enter the user name, email or username\"\n            #input\n          />\n        </mat-form-field>\n\n        <div class=\"table-container mat-elevation-z8\">\n          <table mat-table [dataSource]=\"usersDataSource\" matSort #usersSort>\n            <ng-container matColumnDef=\"id\">\n              <th mat-header-cell *matHeaderCellDef mat-sort-header>ID</th>\n              <td mat-cell *matCellDef=\"let user\">{{ user.id }}</td>\n            </ng-container>\n\n            <ng-container matColumnDef=\"name\">\n              <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>\n              <td mat-cell *matCellDef=\"let user\">{{ user.firstName }}</td>\n            </ng-container>\n\n            <ng-container matColumnDef=\"email\">\n              <th mat-header-cell *matHeaderCellDef>Email</th>\n              <td mat-cell *matCellDef=\"let user\">{{ user.email }}</td>\n            </ng-container>\n\n            <ng-container matColumnDef=\"username\">\n              <th mat-header-cell *matHeaderCellDef mat-sort-header>\n                Username\n              </th>\n              <td mat-cell *matCellDef=\"let user\">{{ user.username }}</td>\n            </ng-container>\n\n            <ng-container matColumnDef=\"actions\">\n              <th mat-header-cell *matHeaderCellDef>Actions</th>\n              <td mat-cell *matCellDef=\"let user\">\n                <mat-checkbox\n                  color=\"primary\"\n                  (change)=\"markUserAsAdmin(user, $event)\"\n                >\n                  Change to Admin\n                </mat-checkbox>\n              </td>\n            </ng-container>\n\n            <tr\n              mat-header-row\n              *matHeaderRowDef=\"usersDisplayedColumns; sticky: true\"\n            ></tr>\n            <tr\n              mat-row\n              *matRowDef=\"let row; columns: usersDisplayedColumns\"\n            ></tr>\n\n            <tr class=\"mat-row\" *matNoDataRow>\n              <td\n                class=\"mat-cell\"\n                [colSpan]=\"usersDisplayedColumns.length\"\n                align=\"center\"\n              >\n                No user found\n              </td>\n            </tr>\n          </table>\n\n          <mat-paginator\n            #usersPaginator\n            class=\"mat-paginator-sticky\"\n            [pageSizeOptions]=\"[5, 10, 25, 100]\"\n          ></mat-paginator>\n        </div>\n      </div>\n    </mat-tab>\n  </mat-tab-group>\n</div>\n","import {\n  ChangeDetectorRef,\n  Component,\n  QueryList,\n  ViewChild,\n} from '@angular/core';\nimport { MatCheckboxChange } from '@angular/material/checkbox';\nimport { MatDialog } from '@angular/material/dialog';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { MatSort } from '@angular/material/sort';\nimport { MatTableDataSource } from '@angular/material/table';\nimport {\n  AlertService,\n  AuthService,\n  ProductsService,\n} from 'src/app/core/services';\nimport { LoadingSpinnerService } from 'src/app/core/services/spinner/loading-spinner.service';\nimport { IProduct, IUser } from 'src/app/shared/models';\nimport { ProductDialogComponent } from '../../components/product-dialog/product-dialog.component';\n\n@Component({\n  templateUrl: './admin.component.html',\n  styleUrls: ['./admin.component.scss'],\n})\nexport class AdminComponent {\n  productsDisplayedColumns: string[] = [\n    'id',\n    'title',\n    'category',\n    'stock',\n    'price',\n    'actions',\n  ];\n  usersDisplayedColumns: string[] = [\n    'id',\n    'name',\n    'email',\n    'username',\n    'actions',\n  ];\n  productsDataSource!: MatTableDataSource<IProduct>;\n  usersDataSource!: MatTableDataSource<IUser>;\n\n  // table paginators\n  @ViewChild('productsPaginator', { read: MatPaginator })\n  productsPaginator!: MatPaginator;\n  @ViewChild('usersPaginator', { read: MatPaginator })\n  usersPaginator!: MatPaginator;\n\n  // table sorts\n  @ViewChild('productsSort', { read: MatSort }) productsSort!: MatSort;\n  @ViewChild('usersSort', { read: MatSort }) usersSort!: MatSort;\n\n  constructor(\n    private productsService: ProductsService,\n    private authService: AuthService,\n    private dialog: MatDialog,\n    private cdr: ChangeDetectorRef,\n    private spinner: LoadingSpinnerService,\n    private alert: AlertService\n  ) {}\n\n  ngOnInit() {\n    this.productsService.getProducts().then((products) => {\n      this.productsDataSource = new MatTableDataSource(products);\n\n      this.productsDataSource.filterPredicate = this.productFilterPredicate;\n      this.productsDataSource.paginator = this.productsPaginator;\n      this.productsDataSource.sort = this.productsSort;\n    });\n  }\n\n  ngAfterViewInit(): void {\n    const nonAdminUsers: IUser[] = this.authService\n      .getPlatformUsers()\n      .filter((user) => user.role !== 'admin');\n    this.usersDataSource = new MatTableDataSource(nonAdminUsers);\n    this.cdr.detectChanges();\n\n    this.usersDataSource.filterPredicate = this.userFilterPredicate;\n    this.usersDataSource.paginator = this.usersPaginator;\n    this.usersDataSource.sort = this.usersSort;\n  }\n\n  private productFilterPredicate(data: IProduct, filter: string): boolean {\n    const lowerCaseFilter = filter.toLowerCase();\n    return (\n      data.title.toLowerCase().includes(lowerCaseFilter) ||\n      data.category.toLowerCase().includes(lowerCaseFilter)\n    );\n  }\n\n  private userFilterPredicate(data: IUser, filter: string): boolean {\n    const lowerCaseFilter = filter.toLowerCase();\n    return (\n      data.firstName.toLowerCase().includes(lowerCaseFilter) ||\n      data.email.toLowerCase().includes(lowerCaseFilter) ||\n      data.username.toLowerCase().includes(lowerCaseFilter)\n    );\n  }\n\n  openProductDialog(id?: number) {\n    const dialogRef = this.dialog.open(ProductDialogComponent, {\n      width: '50%',\n      data: id,\n    });\n\n    dialogRef.afterClosed().subscribe(async (result: IProduct) => {\n      if (result) {\n        if (id) {\n          try {\n            this.spinner.show();\n            const products = await this.productsService.updateProduct(result);\n            this.productsDataSource.data = products;\n            this.cdr.detectChanges();\n          } catch (error) {\n            console.log(error);\n            this.alert.createErrorDialog('Failed to update product', '');\n          } finally {\n            this.spinner.hide();\n          }\n        } else {\n          try {\n            this.spinner.show();\n            const products = await this.productsService.addNewProduct(result);\n            this.productsDataSource.data = products;\n            this.cdr.detectChanges();\n          } catch (error) {\n            console.log(error);\n            this.alert.createErrorDialog('Failed to add a product', '');\n          } finally {\n            this.spinner.hide();\n          }\n        }\n      }\n    });\n  }\n\n  markUserAsAdmin(user: IUser, ev: MatCheckboxChange) {\n    const checked = ev.checked;\n    if (checked) {\n      this.alert.createConfirmDenyDialog(\n        'Change to Admin',\n        `Do you want to turn ${user.firstName} to an administrator?`,\n        async () => {\n          this.usersDataSource.data = this.authService.changeUserToAdmin(user);\n          this.cdr.detectChanges();\n        },\n        () => {\n          ev.source.checked = false;\n        }\n      );\n    }\n  }\n\n  applyProductsFilter(event: KeyboardEvent) {\n    const filterValue = (event.target as HTMLInputElement).value;\n    this.productsDataSource.filter = filterValue.trim().toLowerCase();\n\n    if (this.productsDataSource.paginator) {\n      this.productsDataSource.paginator.firstPage();\n    }\n  }\n\n  applyUserFilter(event: KeyboardEvent) {\n    const filterValue = (event.target as HTMLInputElement).value;\n    this.usersDataSource.filter = filterValue.trim().toLowerCase();\n\n    if (this.usersDataSource.paginator) {\n      this.usersDataSource.paginator.firstPage();\n    }\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { AdminComponent } from './admin.component';\n\nconst routes: Routes = [{ path: '', component: AdminComponent }];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class AdminRoutingModule {}\n","import { NgModule } from '@angular/core';\n\nimport { AdminRoutingModule } from './admin-routing.module';\nimport { AdminComponent } from './admin.component';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { AccountModule } from '../../account.module';\n\n@NgModule({\n  declarations: [AdminComponent],\n  imports: [SharedModule, AdminRoutingModule, AccountModule],\n})\nexport class AdminModule {}\n"],"x_google_ignoreList":[]}